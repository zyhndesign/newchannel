var ZY=ZY||{};ZY.UIManager=function(){var e=0,t=!1,a="",i=$("#zy_nav").height(),n=$("#zy_landscape_theme .zy_theme_bg_content"),o=$("#zy_people_theme .zy_theme_bg_content"),s=$("#zy_artifact_theme .zy_theme_bg_content"),c=$("#zy_community_theme .zy_theme_bg_content"),d=$(".zy_featured").offset().top,_=$("#zy_landscape").offset().top,l=$("#zy_people").offset().top,r=$("#zy_artifact").offset().top,u=$("#zy_community").offset().top,p=$(".zy_footer").offset().top,y=function(t){e=$("#zy_wrap").css("z-index"),$("#zy_wrap").css("z-index",t),$("#zy_wrap").hasClass("zy_hidden")&&$("#zy_wrap").removeClass("zy_hidden")},z=function(){$("#zy_wrap").hasClass("zy_hidden")||($("#zy_wrap").addClass("zy_hidden"),$("#zy_wrap").css("z-index",e))};return{musicLiLength:0,scrollToTarget:function(e){var t=$(e).offset().top;void 0!=t&&(TweenLite.killTweensOf(window),TweenLite.to(window,1,{scrollTo:{y:t+10,x:0}}))},showArticle:function(e,t){var a=this;$("#zy_article_content").find("article").remove(),y(9996),$("#zy_article_container").animate({left:"0%"},300,function(){a.callLoadingSpinner($("#zy_article_content")),ZY.DataManager.get_posts_detail(e,t)})},hideArticle:function(){$("#zy_article_container").animate({left:"100%"},300),z(),this.hideLoadingSpinner($("#zy_article_content"))},showVideoDetail:function(e){var t=this;$("#zy_show_load_container").html(""),y(9998),$("#zy_show_section").removeClass("zy_hidden"),$("#zy_show_load_container").load(e,function(e,a,i){t.hideLoadingSpinner($("#zy_article_content")),"error"==a&&t.popOutMsg(ZY.Config.errorCode.connectionError+i.status+" "+i.statusText)}),$("#zy_music_audio")[0].pause()},showImageDetail:function(e){y(9998),$("#zy_show_section").removeClass("zy_hidden"),$("#zy_show_load_container").html("<img src='"+e+"'>")},hideDetail:function(){var a=$("#zy_music_audio")[0];$("#zy_wrap").css("z-index",e),$("#zy_show_section").addClass("zy_hidden"),$("#zy_show_load_container").html(""),t&&a.play()},initMusicPlayer:function(){var e=this,t=$("#zy_music_audio");$("#zy_music_control").click(function(){e.toggleMusicPlayPause()}),$("#zy_music_next").click(function(){e.nextMusic()}),t[0].addEventListener("timeupdate",function(){var e=$(this)[0],t=e.duration,a=e.currentTime;$("#zy_music_process_value").css("width",a/t*100+"%")}),t[0].addEventListener("ended",function(){e.nextMusic()})},toggleMusicPlayPause:function(){0!=this.musicLiLength&&($("#zy_music_control").hasClass("zy_music_play")?this.playMusic():$("#zy_music_control").hasClass("zy_music_pause")&&this.pauseMusic())},pauseMusic:function(){var e=$("#zy_music_audio");e[0].pause(),t=!1,e.attr("autoplay",!1),$("#zy_music_control").removeClass("zy_music_pause").addClass("zy_music_play")},playMusic:function(){var e=$("#zy_music_audio");e[0].play(),t=!0,e.attr("autoplay","autoplay"),$("#zy_music_control").addClass("zy_music_pause").removeClass("zy_music_play")},nextMusic:function(){if(0!=this.musicLiLength){$("#zy_music_process_value").stop().width("0%");var e=0!=$(".active_music").next().length?$(".active_music").next():$("#zy_music_list li:eq(0)");$(".active_music").removeClass("active_music"),$("#zy_music_audio").attr("src",e.html()),$("#zy_music_author").html("Directed by "+e.data("music-author")),$("#zy_music_title").html(e.data("music-title")),e.addClass("active_music")}},popOutInit:function(){var e=this;$("#zy_popout_win>.zy_popout_btn").on("click",function(){e.popOutHide()}),$("#zy_popout_win").hasClass("zy_hidden")||$("#zy_popout_win").addClass("zy_hidden")},popOutMsg:function(e,t){$("#zy_popout_win").hasClass("zy_hidden")&&$("#zy_popout_win").removeClass("zy_hidden").find(".zy_popout_title").html(e),t&&y(9999)},popOutHide:function(){$("#zy_popout_win").addClass("zy_hidden").find(".zy_popout_title").html("")},callLoadingSpinner:function(e){var t="<div class='zy_loading_spinner'><div class='zy_loading_spinner_layer1'></div><div class='zy_loading_spinner_layer2'></div></div>",a=$(t);$(e).find(".zy_loading_spinner").length<=0&&$(e).append(a)},hideLoadingSpinner:function(e){$(e).find(".zy_loading_spinner").detach()},updateSectionBG:function(e,t){e.background&&("mp4"!=e.background.type?$(t).append($("<img class='zy_theme_bg_content' src='"+e.background.filepath+"' onload='ZY.UIManager.fadingIn(this)' />")):ZY.Config.deviceCode.iOS||$(t).append($("<video class='zy_theme_bg_content' autoplay loop muted oncanplay='ZY.UIManager.fadingIn(this)'><source src='"+e.background.filepath+"' type='video/mp4' /></video>")),n=$("#zy_landscape_theme .zy_theme_bg_content"),o=$("#zy_people_theme .zy_theme_bg_content"),s=$("#zy_artifact_theme .zy_theme_bg_content"),c=$("#zy_community_theme .zy_theme_bg_content"))},bindHScrollOnWheel:function(e){var t=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",a=function(t){var a=0;t=window.event||t,a=t.wheelDelta<0||t.detail>0?e.scrollLeft+500:e.scrollLeft-500,TweenLite.to(e,.5,{scrollTo:{x:a}}),t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!1)};e.addEventListener(t,a)},setWheelScrollSpeed:function(){var e=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",t=function(e){var t=$(window).scrollTop();e=window.event||e,$(window).scrollTop(e.wheelDelta<0||e.detail>0?t+100:t-100),e.preventDefault?e.preventDefault():e.returnValue=!1};window.addEventListener(e,t)},fadingIn:function(e){$(e).css("opacity",1)},scrollingHandler:function(){var e=window.pageYOffset,t=$(window).height(),y=$(window).width();d>=e&&$("#zy_nav").css("top",100+(_-i-200)/d*e),$(".zy_top_nav ul li a").removeClass("active"),_>=e||(l>=e?$(".zy_top_nav ul li:nth-child(1) a").addClass("active"):r>=e?$(".zy_top_nav ul li:nth-child(2) a").addClass("active"):u>=e?$(".zy_top_nav ul li:nth-child(3) a").addClass("active"):p>=e&&$(".zy_top_nav ul li:nth-child(4) a").addClass("active")),e>_-t&&_+720>=e?(ZY.Config.deviceCode.iOS||(n.addClass("zy_bg_fixed"),a="rect(0px "+y+"px "+(720-(e-_)+100)+"px 0px)",n.css("clip",a)),ZY.DataManager.landscapeLoaded||(ZY.DataManager.zy_get_posts($("#zy_landscape_contain"),ZY.Config.articleWidths.sectionOneWidth,ZY.Config.categoryIds.sectionOneId,ZY.DataManager.lastLandscapeDate,!0),ZY.DataManager.landscapeLoaded=!0)):ZY.Config.deviceCode.iOS||(n.removeClass("zy_bg_fixed"),n.css("clip","")),e>l-t&&l+720>=e?(ZY.Config.deviceCode.iOS||(o.addClass("zy_bg_fixed"),a="rect(0px "+y+"px "+(720-(e-l)+100)+"px 0px)",o.css("clip",a)),ZY.DataManager.peopleLoaded||(ZY.DataManager.zy_get_posts($("#zy_people_contain"),ZY.Config.articleWidths.sectionTwoWidth,ZY.Config.categoryIds.sectionTwoId,ZY.DataManager.lastPeopleDate,!0),ZY.DataManager.peopleLoaded=!0)):ZY.Config.deviceCode.iOS||(o.removeClass("zy_bg_fixed"),o.css("clip","")),e>r-t&&r+720>=e?(ZY.Config.deviceCode.iOS||(s.addClass("zy_bg_fixed"),a="rect(0px "+y+"px "+(720-(e-r)+100)+"px 0px)",s.css("clip",a)),ZY.DataManager.artifactLoaded||(ZY.DataManager.zy_get_posts($("#zy_artifact_contain"),ZY.Config.articleWidths.sectionThreeWidth,ZY.Config.categoryIds.sectionThreeId,ZY.DataManager.lastArtifactDate,!0),ZY.DataManager.artifactLoaded=!0)):ZY.Config.deviceCode.iOS||(s.removeClass("zy_bg_fixed"),s.css("clip","")),e>u-t&&u+720>=e?(ZY.Config.deviceCode.iOS||(c.addClass("zy_bg_fixed"),a="rect(0px "+y+"px "+(720-(e-u)+100)+"px 0px)",c.css("clip",a)),ZY.DataManager.communityLoaded||(ZY.DataManager.zy_get_posts($("#zy_community_contain"),ZY.Config.articleWidths.sectionFourWidth,ZY.Config.categoryIds.sectionFourId,ZY.DataManager.lastCommunityDate,!0),ZY.DataManager.communityLoaded=!0)):ZY.Config.deviceCode.iOS||(c.removeClass("zy_bg_fixed"),c.css("clip",""))},doResizeOfCategory:function(e,t,a){var i=parseInt($("body").width()/t),n=e.find("a.zy_contain_next"),o=e.find("ul"),s=e.find(".zy_list_container");s.width(i*t),parseInt(o.css("left"))>-(o.find("li").length-i)*t&&a?n.removeClass("zy_disable"):a&&n.addClass("zy_disable")}}}();