var ZY=ZY||{};ZY.config={ajaxurl:"http://www.comdesignlab.com/travel/wp-admin/admin-ajax.php",siteurl:"http://www.comdesignlab.com/travel",categoryIds:{tdId:37,sectionOneId:23,sectionTwoId:24,sectionThreeId:25,sectionFourId:28},articleWidths:{sectionOneWidth:320,sectionTwoWidth:240,sectionThreeWidth:205,sectionFourWidth:240},errorCode:{connectionError:"NetWork Error!",musicError:"Get Music Data Error!",hasNoMusic:"No Music!",postsError:"Get Post Data Error!",articleError:"Get Post Detail Error!ã€‚"},deviceCode:{iOS:navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?true:false},defaultWrapZindex:9996};Object.freeze(ZY.config);var ZY=ZY||{};ZY.controllerManager=function(){var rect="";var topH=$("#zy_top_post").height();var sectionOneBG=$("#zy_section_one_bg .zy_theme_bg_content");var sectionTwoBG=$("#zy_section_two_bg .zy_theme_bg_content");var sectionThreeBG=$("#zy_section_three_bg .zy_theme_bg_content");var sectionFourBG=$("#zy_section_four_bg .zy_theme_bg_content");var menu=$("#zy_nav");var sectionOneY=$("#zy_section_one").offset().top-80;var sectionTwoY=$("#zy_section_two").offset().top-80;var sectionThreeY=$("#zy_section_three").offset().top-80;var sectionFourY=$("#zy_section_four").offset().top-80;var footerY=$(".zy_footer").offset().top-80;function setMaxLimit(categoryId,limit){if(categoryId==ZY.config.categoryIds.sectionOneId){if(limit>3){limit=3}}else{if(limit>4){limit=4}}return limit}return{judgeShowOrNot:function(parent,target){if(target.parents(parent).length==0){ZY.uiManager.hideMusicPlayer()}},splitPostDate:function(date){if(typeof date=="string"){var dateArray=date.split("-");var newArray=[];newArray[0]=dateArray[2]+"/"+dateArray[1];newArray[1]=dateArray[0];return newArray}return[]},transformDatas:function(datas){var me=this;var array=[];$.each(datas,function(index,d){array=me.splitPostDate(d["post_date"]);d["post_month"]=array[0];d["post_year"]=array[1]});return datas},setLoadLimit:function(args){var limit=parseInt($("body").width()/args.width);limit=setMaxLimit(args.categoryId,limit);args.targetContain.find(".zy_post_list_container").width(limit*args.width);args.targetContain.find(".zy_page_next").addClass("zy_disable");ZY.uiManager.showLoadingSpinner($(args.targetContain));if(args.isFirst){if(args.categoryId==ZY.config.categoryIds.sectionThreeId){if($("body").width()>=ZY.config.articleWidths.sectionThreeWidth*2){limit=parseInt(($("body").width()-ZY.config.articleWidths.sectionThreeWidth*2)/args.width)*2+limit*2*2+1}}else if(args.categoryId==ZY.config.categoryIds.sectionOneId){limit=limit*3*2}else{limit=limit*3}}else{if(args.categoryId==ZY.config.categoryIds.sectionOneId||args.categoryId==ZY.config.categoryIds.sectionThreeId){limit=limit*2*2}else{limit=limit*2}}return limit},doResponse:function(args){var length=args.posts.length;var nextBtn=args.targetContain.find(".zy_page_next");if(length<=args.limit){if(length!=0){this.handlerPosts(args.categoryId,args.posts,length,args.isFirst)}nextBtn.removeClass("zy_disable");if(args.categoryId==ZY.config.categoryIds.sectionThreeId){if(args.isFirst&&length<=(args.limit+1)/3-1){nextBtn.addClass("zy_disable")}}else{if(args.isFirst&&length<=args.limit/3){nextBtn.addClass("zy_disable")}}if(length<args.limit){nextBtn.addClass("zy_no_more")}}},setBackGround:function(isFirst,firstPost,categoryId){if(isFirst&&firstPost["post_id"]!=ZY.dataManager.topPostId){if(categoryId==ZY.config.categoryIds.sectionTwoId){ZY.uiManager.updateSectionBg(firstPost,$("#zy_section_two_theme"));sectionTwoBG=$("#zy_section_two_bg .zy_theme_bg_content")}else if(categoryId==ZY.config.categoryIds.sectionOneId){ZY.uiManager.updateSectionBg(firstPost,$("#zy_section_one_theme"));sectionOneBG=$("#zy_section_one_bg .zy_theme_bg_content")}else if(categoryId==ZY.config.categoryIds.sectionFourId){ZY.uiManager.updateSectionBg(firstPost,$("#zy_section_four_theme"));sectionFourBG=$("#zy_section_four_bg .zy_theme_bg_content")}else if(categoryId==ZY.config.categoryIds.sectionThreeId){ZY.uiManager.updateSectionBg(firstPost,$("#zy_section_three_theme"));sectionThreeBG=$("#zy_section_three_bg .zy_theme_bg_content")}}},handlerPosts:function(categoryId,posts,length,isFirst){if(categoryId==ZY.config.categoryIds.sectionTwoId){ZY.dataManager.lastSectionTwoDate=posts[length-1]["post_full_date"];ZY.uiManager.showSectionTwoPosts(posts)}else if(categoryId==ZY.config.categoryIds.sectionOneId){ZY.dataManager.lastSectionOneDate=posts[length-1]["post_full_date"];ZY.uiManager.showSectionOnePosts(this.handlerSectionOnePosts(posts,length))}else if(categoryId==ZY.config.categoryIds.sectionFourId){ZY.dataManager.lastSectionFourDate=posts[length-1]["post_full_date"];ZY.uiManager.showSectionFourPosts(posts)}else if(categoryId==ZY.config.categoryIds.sectionThreeId){ZY.dataManager.lastSectionThreeDate=posts[length-1]["post_full_date"];ZY.uiManager.showSectionThreePosts(this.handlerSectionThreePosts(posts,length,isFirst),isFirst)}},handlerSectionOnePosts:function(posts,length){var array=[];for(var i=0;i<length;i++){var post={};post.top=posts[i];var next=++i;post.bottom=posts[next];array.push(post)}return array},handlerSectionThreePosts:function(posts,length,isFirst){var array=[];for(var i=0;i<length;i++){var post={};if(i==0&&isFirst){post=posts[i]}else{post.top=posts[i];var next=++i;post.bottom=posts[next]}array.push(post)}return array},addHoverEvent:function(targetContain){var nextBtn=targetContain.find(".zy_page_next");var prevBtn=targetContain.find(".zy_page_prev");targetContain.hover(function(){prevBtn.css("opacity",1);nextBtn.css("opacity",1)},function(){prevBtn.css("opacity",0);nextBtn.css("opacity",0)})},nextPage:function(targetContain,width,categoryId,lastDate){var limit=parseInt($("body").width()/width);limit=setMaxLimit(categoryId,limit);var nextBtn=targetContain.find("a.zy_page_next");var prevBtn=targetContain.find("a.zy_page_prev");var container=targetContain.find(".zy_post_list_container");var list=targetContain.find(".zy_post_list_container ul");container.width(limit*width);if(nextBtn.hasClass("zy_no_more")){list.animate({left:parseInt(list.css("left"))-limit*width},500,function(){prevBtn.removeClass("zy_disable");if(categoryId==ZY.config.categoryIds.sectionThreeId){if(parseInt(list.css("left"))<=-(list.find("li").length-limit+1)*width){nextBtn.addClass("zy_disable")}}else{if(parseInt(list.css("left"))<=-(list.find("li").length-limit)*width){nextBtn.addClass("zy_disable")}}})}else{ZY.dataManager.getCategoryPosts({targetContain:targetContain,width:width,categoryId:categoryId,lastDate:lastDate,isFirst:false});list.animate({left:parseInt(list.css("left"))-limit*width},500,function(){prevBtn.removeClass("zy_disable")})}},prevPage:function(targetContain,width,categoryId){var limit=parseInt($("body").width()/width);limit=setMaxLimit(categoryId,limit);var nextBtn=targetContain.find("a.zy_page_next");var prevBtn=targetContain.find("a.zy_page_prev");var container=targetContain.find(".zy_post_list_container");var list=targetContain.find(".zy_post_list_container ul");container.width(limit*width);if(parseInt(list.css("left"))+limit*width>=0){list.animate({left:0},500,function(){if(parseInt(list.css("left"))>-(list.find("li").length-limit)*width){nextBtn.removeClass("zy_disable")}prevBtn.addClass("zy_disable")})}else{if(categoryId==ZY.config.categoryIds.sectionThreeId){if(parseInt(list.css("left"))+limit*width>-400){list.animate({left:-400},500,function(){nextBtn.removeClass("zy_disable")});return}}list.animate({left:parseInt(list.css("left"))+limit*width},500,function(){nextBtn.removeClass("zy_disable")})}},bindHScroll:function(target){var mousewheelEvt=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";var mousewheelHandler=function(evt){var left=0;evt=window.event||evt;if(evt.wheelDelta<0||evt.detail>0){left=target.scrollLeft+500}else{left=target.scrollLeft-500}TweenLite.to(target,.5,{scrollTo:{x:left}});if(evt.preventDefault){evt.preventDefault();evt.stopPropagation()}else{evt.returnValue=false;evt.cancelBubble=false}};target.addEventListener(mousewheelEvt,mousewheelHandler)},setWheelScrollSpeed:function(){var mousewheelEvt=document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll";var mousewheelHandler=function(evt){var top=$(window).scrollTop();evt=window.event||evt;if(evt.wheelDelta<0||evt.detail>0){$(window).scrollTop(top+100)}else{$(window).scrollTop(top-100)}if(evt.preventDefault){evt.preventDefault()}else{evt.returnValue=false}};window.addEventListener(mousewheelEvt,mousewheelHandler)},scrollingHandler:function(){var sy=window.pageYOffset;var winH=$(window).height();var winW=$(window).width();if(sy>=topH){if(!menu.hasClass("zy_nav_active")){menu.addClass("zy_nav_active")}}else{if(menu.hasClass("zy_nav_active")){menu.removeClass("zy_nav_active")}}$("#zy_nav ul li a").removeClass("active");if(sy<=sectionOneY){}else if(sy<=sectionTwoY){$("#zy_nav ul li:nth-child(1) a").addClass("active")}else if(sy<=sectionThreeY){$("#zy_nav ul li:nth-child(2) a").addClass("active")}else if(sy<=sectionFourY){$("#zy_nav ul li:nth-child(4) a").addClass("active")}else if(sy<=footerY){$("#zy_nav ul li:nth-child(5) a").addClass("active")}if(sy>sectionOneY-winH&&sy<=sectionOneY+720){if(!ZY.config.deviceCode.iOS){sectionOneBG.addClass("zy_bg_fixed");rect="rect(0px "+winW+"px "+(800-(sy-sectionOneY)+100)+"px 0px)";sectionOneBG.css("clip",rect)}if(!ZY.dataManager.sectionOneLoaded){ZY.dataManager.getCategoryPosts({width:ZY.config.articleWidths.sectionOneWidth,categoryId:ZY.config.categoryIds.sectionOneId,isFirst:true,lastDate:ZY.dataManager.lastSectionOneDate,targetContain:$("#zy_section_one_contain")});ZY.dataManager.sectionOneLoaded=true}}else{if(!ZY.config.deviceCode.iOS){sectionOneBG.removeClass("zy_bg_fixed");sectionOneBG.css("clip","")}}if(sy>sectionTwoY-winH&&sy<=sectionTwoY+720){if(!ZY.config.deviceCode.iOS){sectionTwoBG.addClass("zy_bg_fixed");rect="rect(0px "+winW+"px "+(800-(sy-sectionTwoY)+100)+"px 0px)";sectionTwoBG.css("clip",rect)}if(!ZY.dataManager.sectionTwoLoaded){ZY.dataManager.getCategoryPosts({width:ZY.config.articleWidths.sectionTwoWidth,categoryId:ZY.config.categoryIds.sectionTwoId,isFirst:true,lastDate:ZY.dataManager.lastSectionTwoDate,targetContain:$("#zy_section_two_contain")});ZY.dataManager.sectionTwoLoaded=true}}else{if(!ZY.config.deviceCode.iOS){sectionTwoBG.removeClass("zy_bg_fixed");sectionTwoBG.css("clip","")}}if(sy>sectionThreeY-winH&&sy<=sectionThreeY+720){if(!ZY.config.deviceCode.iOS){sectionThreeBG.addClass("zy_bg_fixed");rect="rect(0px "+winW+"px "+(840-(sy-sectionThreeY)+100)+"px 0px)";sectionThreeBG.css("clip",rect)}if(!ZY.dataManager.sectionThreeLoaded){ZY.dataManager.getCategoryPosts({targetContain:$("#zy_section_three_contain"),lastDate:ZY.dataManager.lastSectionThreeDate,categoryId:ZY.config.categoryIds.sectionThreeId,width:ZY.config.articleWidths.sectionThreeWidth,isFirst:true});ZY.dataManager.sectionThreeLoaded=true}}else{if(!ZY.config.deviceCode.iOS){sectionThreeBG.removeClass("zy_bg_fixed");sectionThreeBG.css("clip","")}}if(sy>sectionFourY-winH&&sy<=sectionFourY+720){if(!ZY.config.deviceCode.iOS){sectionFourBG.addClass("zy_bg_fixed");rect="rect(0px "+winW+"px "+(840-(sy-sectionFourY)+100)+"px 0px)";sectionFourBG.css("clip",rect)}if(!ZY.dataManager.sectionFourLoaded){ZY.dataManager.getCategoryPosts({width:ZY.config.articleWidths.sectionFourWidth,categoryId:ZY.config.categoryIds.sectionFourId,isFirst:true,lastDate:ZY.dataManager.lastSectionFourDate,targetContain:$("#zy_section_four_contain")});ZY.dataManager.sectionFourLoaded=true}}else{if(!ZY.config.deviceCode.iOS){sectionFourBG.removeClass("zy_bg_fixed");sectionFourBG.css("clip","")}}},doResizeOfCategory:function(targetContain,categoryId,width,loaded){var limit=parseInt($("body").width()/width);limit=setMaxLimit(categoryId,limit);var nextBtn=targetContain.find("a.zy_page_next");var list=targetContain.find("ul");var targetContainer=targetContain.find(".zy_post_list_container");targetContainer.width(limit*width);if(parseInt(list.css("left"))>-(list.find("li").length-limit)*width&&loaded){nextBtn.removeClass("zy_disable")}else{if(loaded){nextBtn.addClass("zy_disable")}}},windowResizeHandler:function(){var me=this;if(ZY.dataManager.resizeTimer){clearTimeout(ZY.dataManager.resizeTimer)}ZY.dataManager.resizeTimer=setTimeout(function(){me.doResizeOfCategory($("#zy_section_two_contain"),ZY.config.categoryIds.sectionTwoId,ZY.config.articleWidths.sectionTwoWidth,ZY.dataManager.sectionTwoLoaded);me.doResizeOfCategory($("#zy_section_one_contain"),ZY.config.categoryIds.sectionOneId,ZY.config.articleWidths.sectionOneWidth,ZY.dataManager.sectionOneLoaded);me.doResizeOfCategory($("#zy_section_four_contain"),ZY.config.categoryIds.sectionFourId,ZY.config.articleWidths.sectionFourWidth,ZY.dataManager.sectionFourLoaded);me.doResizeOfCategory($("#zy_section_three_contain"),ZY.config.categoryIds.sectionThreeId,ZY.config.articleWidths.sectionThreeWidth,ZY.dataManager.sectionThreeLoaded)},200)}}}();var ZY=ZY||{};ZY.dataManager={topPostId:0,lastSectionTwoDate:"",lastSectionThreeDate:"",lastSectionFourDate:"",lastSectionOneDate:"",currentPostId:0,sectionOneLoaded:false,sectionThreeLoaded:false,sectionFourLoaded:false,sectionTwoLoaded:false,resizeTimer:null,getMusic:function(){$.ajax({url:ZY.config.ajaxurl,type:"post",data:{action:"zy_get_music",programId:ZY.config.categoryIds.tdId},success:function(response){if(response.success){if(response.data.length!=0){var musics=response.data;ZY.music.setMusicList(musics)}else{$("#zy_music_title").text(ZY.config.errorCode.hasNoMusic)}}else{ZY.uiManager.showPopOut(ZY.config.errorCode.musicError,false)}},error:function(){ZY.uiManager.showPopOut(ZY.config.errorCode.connectionError,false)}})},getTopPosts:function(){$.ajax({url:ZY.config.ajaxurl,type:"post",data:{action:"zy_get_top_posts",programId:ZY.config.categoryIds.tdId},success:function(response){if(response.success){if(response.data.length!=0){var posts=response.data;this.topPostId=posts[0]["post_id"];posts=ZY.controllerManager.transformDatas(posts);ZY.uiManager.showTopPost(posts);ZY.uiManager.showFeaturePosts(posts)}}else{ZY.uiManager.showPopOut(ZY.config.errorCode.postsError,false)}},error:function(){ZY.uiManager.showPopOut(ZY.config.errorCode.connectionError,false)}})},getCategoryPosts:function(args){var limit=ZY.controllerManager.setLoadLimit({targetContain:args.targetContain,width:args.width,categoryId:args.categoryId,isFirst:args.isFirst});$.ajax({url:ZY.config.ajaxurl,type:"post",data:{limit:limit,lastDate:args.lastDate,categoryId:args.categoryId,action:"zy_get_posts"},success:function(response){if(response.success){var posts=response.data;ZY.controllerManager.doResponse({targetContain:args["targetContain"],posts:posts,isFirst:args["isFirst"],categoryId:args["categoryId"],limit:limit})}else{ZY.uiManager.showPopOut(ZY.config.errorCode.postsError,false)}ZY.uiManager.hideLoadingSpinner($(args.targetContain))},error:function(){ZY.uiManager.hideLoadingSpinner(args.targetContain);ZY.uiManager.showPopOut(ZY.config.errorCode.connectionError,false)}})},getPostDetail:function(post_id){$.ajax({url:ZY.config.ajaxurl,type:"post",data:{post_id:post_id,action:"zy_get_post_detail"},success:function(response){if(response.success){ZY.uiManager.showArticleDetail(response.data)}else{ZY.uiManager.showPopOut(ZY.config.errorCode.articleError,false)}},error:function(){ZY.uiManager.showPopOut(ZY.config.errorCode.connectionError,false)}})}};var ZY=ZY||{};ZY.music={musicPlaying:false,musicLiLength:0,setMusicList:function(musics){var tpl=$("#zy_music_tpl").html();var html=juicer(tpl,{musics:musics});$("#zy_music_list").html(html);$("#zy_music_audio").attr("src",musics[0].music_path);$("#zy_music_title").html(musics[0].music_title);this.musicLiLength=musics.length},musicControlHandler:function(){if(this.musicLiLength!=0){var musicControl=$("#zy_music_control");if(musicControl.hasClass("zy_music_play")){this.musicPlay()}else if(musicControl.hasClass("zy_music_pause")){this.musicPause()}}},musicPlay:function(){var audio=$("#zy_music_audio");audio[0].play();$("#zy_music_show").addClass("zy_music_show_play");$("#zy_music_control").addClass("zy_music_pause").removeClass("zy_music_play");audio.attr("autoplay","autoplay");this.musicPlaying=true},musicPause:function(){var audio=$("#zy_music_audio");audio[0].pause();$("#zy_music_show").removeClass("zy_music_show_play");$("#zy_music_control").removeClass("zy_music_pause").addClass("zy_music_play");audio.attr("autoplay",false);this.musicPlaying=false},musicPrev:function(){if(this.musicLiLength!=0){$("#zy_music_timeline").stop().width("0%");var activeMusic=$(".active_music");var audio=$("#zy_music_audio");var target=activeMusic.prev().length!=0?activeMusic.prev():$("#zy_music_list li:last");activeMusic.removeClass("active_music");audio.attr("src",target.html());$("#zy_music_author").html(target.data("music-author"));$("#zy_music_title").html(target.data("music-title"));target.addClass("active_music")}},musicNext:function(){if(this.musicLiLength!=0){$("#zy_music_timeline").stop().width("0%");var activeMusic=$(".active_music");var audio=$("#zy_music_audio");var target=activeMusic.next().length!=0?activeMusic.next():$("#zy_music_list li:first");activeMusic.removeClass("active_music");audio.attr("src",target.html());$("#zy_music_author").html(target.data("music-author"));$("#zy_music_title").html(target.data("music-title"));target.addClass("active_music")}},musicEndHandler:function(){var me=this;$("#zy_music_audio")[0].addEventListener("ended",function(){me.musicNext()})},musicTimeLine:function(){$("#zy_music_audio")[0].addEventListener("timeupdate",function(){var audio=$(this)[0];var totalTime=audio.duration;var currentTime=audio.currentTime;$("#zy_music_timeline").css("width",currentTime/totalTime*100+"%")})}};var ZY=ZY||{};ZY.uiManager=function(){return{showMusicPlayer:function(){$("#zy_music_section").animate({width:"100%"},100,function(){$("#zy_music_player").removeClass("zy_hidden")})},hideMusicPlayer:function(){$("#zy_music_section").stop(true,true).width(60);$("#zy_music_player").addClass("zy_hidden")},scrollToTarget:function(target){var top=target.offset().top;if(!$("#zy_nav").hasClass("zy_nav_active")){top=top-80}if(top!=undefined){TweenLite.killTweensOf(window);if(target.is("#zy_section_three")){TweenLite.to(window,1,{scrollTo:{y:top+35,x:0}})}else if(target.is("#zy_section_four")){TweenLite.to(window,1,{scrollTo:{y:top+35,x:0}})}else{TweenLite.to(window,1,{scrollTo:{y:top+1,x:0}})}}},showTopPost:function(posts){var tpl_top=$("#zy_top_post_tpl").html();var html_top=juicer(tpl_top,{top_posts:posts});$("#zy_top_post_heading").html(html_top);this.updateSectionBg(posts[0],$("#zy_top_post_poster"))},showFeaturePosts:function(posts){var tpl_featured=$("#zy_featured_articles_tpl").html();var html_featured=juicer(tpl_featured,{top_posts:posts});$("#zy_featured_articles").html(html_featured)},updateSectionBg:function(data,target){if(data["background"]!==null){if(data["background"]["type"]!="mp4"){target.append($("<img class='zy_theme_bg_content' src='"+data["background"]["filepath"]+"' onload='ZY.uiManager.fadingIn(this)' />"))}else if(!ZY.config.deviceCode.iOS){target.append($("<video class='zy_theme_bg_content' autoplay loop muted "+"oncanplay='ZY.uiManager.fadingIn(this)'><source src='"+data["background"]["filepath"]+"' type='video/mp4' /></video>"))}}},fadingIn:function(target){$(target).css("opacity",1)},showLoadingSpinner:function(target){var spinnerDOM=$("#zy_spinner_tpl").html();if(target.find(".zy_loading_spinner").length<=0){target.append($(spinnerDOM))}},hideLoadingSpinner:function(target){target.find(".zy_loading_spinner").remove()},showSectionOnePosts:function(posts){var tpl=$("#zy_section_one_articles_tpl").html();var html=juicer(tpl,{posts:posts});$("#zy_section_one_list").append($(html))},showSectionTwoPosts:function(posts){var tpl=$("#zy_section_two_articles_tpl").html();var html=juicer(tpl,{posts:posts});$("#zy_section_two_list").append($(html))},showSectionFourPosts:function(posts){var tpl=$("#zy_section_four_articles_tpl").html();var html=juicer(tpl,{posts:posts});$("#zy_section_four_list").append($(html))},showSectionThreePosts:function(posts,isFirst){var tpl=$("#zy_section_three_articles_tpl").html();var html=juicer(tpl,{posts:posts,isFirst:isFirst});$("#zy_section_three_list").append($(html))},showArticle:function(post_id){var me=this;$("#zy_article_content").find("article").remove();me.showBlackout(ZY.config.defaultWrapZindex);$("#zy_article_container").animate({left:"0%"},300,function(){me.showLoadingSpinner($("#zy_article_content"));ZY.dataManager.getPostDetail(post_id)})},hideArticle:function(){var me=this;me.hideLoadingSpinner($("#zy_article_content"));$("#zy_article_container").animate({left:"100%"},300,function(){me.hideBlackout()})},showBlackout:function(zIndex){var wrap=$("#zy_wrap");wrap.css("z-index",zIndex);if(wrap.hasClass("zy_hidden")){wrap.removeClass("zy_hidden")}},hideBlackout:function(){var wrap=$("#zy_wrap");if(!wrap.hasClass("zy_hidden")){wrap.addClass("zy_hidden");wrap.css("z-index",ZY.config.defaultWrapZindex)}},showArticleDetail:function(data){var tpl=$("#zy_show_detail_tpl").html();var html=juicer(tpl,data);var article_content=$("#zy_article_content");article_content.append(html);ZY.uiManager.hideLoadingSpinner(article_content)},showVideoDetail:function(url){var me=this,loadContainer=$("#zy_show_load_container");$("#zy_music_audio")[0].pause();loadContainer.html("");me.showBlackout(9998);$("#zy_show_section").removeClass("zy_hidden");loadContainer.load(url,function(response,status,xhr){me.hideLoadingSpinner($("#zy_article_content"));if(status=="error"){me.showPopOut(ZY.config.errorCode.connectionError+xhr.status+" "+xhr.statusText,false)}})},showImageDetail:function(url){this.showBlackout(9998);$("#zy_show_section").removeClass("zy_hidden");$("#zy_show_load_container").html("<img src='"+url+"'>")},hideDetail:function(){var audio=$("#zy_music_audio")[0];this.showBlackout(ZY.config.defaultWrapZindex);$("#zy_show_section").addClass("zy_hidden");$("#zy_show_load_container").html("");if(ZY.music.musicPlaying){audio.play()}},showPopOut:function(msg,showblackout){var pop=$("#zy_popout_win");pop.removeClass("zy_hidden").find(".zy_popout_title").html(msg);if(showblackout){this.showBlackout(9999)}},hidePopOut:function(){$("#zy_popout_win").addClass("zy_hidden")}}}();$(document).ready(function(){ZY.dataManager.getMusic();ZY.music.musicTimeLine();ZY.music.musicEndHandler();$("#zy_music_prev").click(function(){ZY.music.musicPrev()});$("#zy_music_next").click(function(){ZY.music.musicNext()});$("#zy_music_control").click(function(){ZY.music.musicControlHandler()});$("#zy_music_show").mouseenter(function(){ZY.uiManager.showMusicPlayer()});$("#zy_music_section").mouseleave(function(){ZY.uiManager.hideMusicPlayer()});$("#zy_nav a").click(function(){var target=$(this).attr("href");ZY.uiManager.scrollToTarget($(target));return false});$("#zy_logo a").click(function(){ZY.uiManager.scrollToTarget($("#zy_top_post"));return false});ZY.dataManager.getTopPosts();ZY.controllerManager.addHoverEvent($("#zy_section_one_contain"));ZY.controllerManager.addHoverEvent($("#zy_section_two_contain"));ZY.controllerManager.addHoverEvent($("#zy_section_three_contain"));ZY.controllerManager.addHoverEvent($("#zy_section_four_contain"));$("#zy_section_one_next").click(function(){ZY.controllerManager.nextPage($("#zy_section_one_contain"),ZY.config.articleWidths.sectionOneWidth,ZY.config.categoryIds.sectionOneId,ZY.dataManager.lastSectionOneDate)});$("#zy_section_one_prev").click(function(){ZY.controllerManager.prevPage($("#zy_section_one_contain"),ZY.config.articleWidths.sectionOneWidth,ZY.config.categoryIds.sectionOneId)});$("#zy_section_two_next").click(function(){ZY.controllerManager.nextPage($("#zy_section_two_contain"),ZY.config.articleWidths.sectionTwoWidth,ZY.config.categoryIds.sectionTwoId,ZY.dataManager.lastSectionTwoDate)});$("#zy_section_two_prev").click(function(){ZY.controllerManager.prevPage($("#zy_section_two_contain"),ZY.config.articleWidths.sectionTwoWidth,ZY.config.categoryIds.sectionTwoId)});$("#zy_section_three_next").click(function(){ZY.controllerManager.nextPage($("#zy_section_three_contain"),ZY.config.articleWidths.sectionThreeWidth,ZY.config.categoryIds.sectionThreeId,ZY.dataManager.lastSectionThreeDate)});$("#zy_section_three_prev").click(function(){ZY.controllerManager.prevPage($("#zy_section_three_contain"),ZY.config.articleWidths.sectionThreeWidth,ZY.config.categoryIds.sectionThreeId)});$("#zy_section_four_next").click(function(){ZY.controllerManager.nextPage($("#zy_section_four_contain"),ZY.config.articleWidths.sectionFourWidth,ZY.config.categoryIds.sectionFourId,ZY.dataManager.lastSectionFourDate)});$("#zy_section_four_prev").click(function(){ZY.controllerManager.prevPage($("#zy_section_four_contain"),ZY.config.articleWidths.sectionFourWidth,ZY.config.categoryIds.sectionFourId)});$(document).on("click","li[data-zy-post-type^=zy],div[data-zy-post-type^=zy],h2[data-zy-post-type^=zy]",function(){ZY.dataManager.currentPostId=$(this).data("zy-post-id");ZY.uiManager.showArticle(ZY.dataManager.currentPostId)});ZY.controllerManager.bindHScroll($("#zy_article_content")[0]);$("#zy_article_container_close").click(function(){ZY.uiManager.hideArticle()});$(document).on("click","#zy_article_content a",function(){var url="";var elementA=$(this);if(elementA.hasClass("videoslide")){url=ZY.config.siteurl+"/show_media/"+ZY.dataManager.currentPostId+"/"+elementA.find("img").data("zy-media-id");ZY.uiManager.showVideoDetail(url);return false}else if(elementA.find("img")){url=elementA.attr("href");ZY.uiManager.showImageDetail(url);return false}else{window.open(elementA.attr("href"))}});$("#zy_show_close").click(function(){ZY.uiManager.hideDetail()});$("#zy_popout_close").click(function(){ZY.uiManager.hidePopOut()});$(window).resize(function(){ZY.controllerManager.windowResizeHandler()});$(window).scroll(function(){ZY.controllerManager.scrollingHandler()});$(window).trigger("scroll");ZY.controllerManager.setWheelScrollSpeed();if(ZY.config.deviceCode.iOS){$(".zy_article_content").addClass("zy_touch_hscroll");$("#zy_section_one_list_container").addClass("zy_touch_hscroll");$("#zy_section_two_list_container").addClass("zy_touch_hscroll");$("#zy_section_three_list_container").addClass("zy_touch_hscroll");$("#zy_section_four_list_container").addClass("zy_touch_hscroll")}});