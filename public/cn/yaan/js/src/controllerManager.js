var ZY=ZY||{};ZY.controllerManager=function(){var e=$("#zy_top_post").height(),t=$("#zy_section_one_bg .zy_theme_bg_content"),a=$("#zy_section_two_bg .zy_theme_bg_content"),n=$("#zy_section_three_bg .zy_theme_bg_content"),i=$("#zy_section_four_bg .zy_theme_bg_content"),o=$("#zy_nav"),s=$("#zy_section_one").offset().top,l=$("#zy_section_two").offset().top,c=$("#zy_section_three").offset().top,r=$("#zy_section_four").offset().top,d=$(".zy_footer").offset().top;return{judgeShowOrNot:function(e,t){0==t.parents(e).length&&ZY.uiManager.hideMusicPlayer()},splitPostDate:function(e){if("string"==typeof e){var t=e.split("-"),a=[];return a[0]=t[2]+"/"+t[1],a[1]=t[0],a}return[]},transformDatas:function(e){var t=this,a=[];return $.each(e,function(e,n){a=t.splitPostDate(n.post_date),n.post_month=a[0],n.post_year=a[1]}),e},setBackGround:function(e,o,s){e&&o.post_id!=ZY.dataManager.topPostId&&(s==ZY.config.categoryIds.sectionTwoId?(ZY.uiManager.updateSectionBg(o,$("#zy_section_two_theme")),a=$("#zy_section_two_bg .zy_theme_bg_content")):s==ZY.config.categoryIds.sectionOneId?(ZY.uiManager.updateSectionBg(o,$("#zy_section_one_theme")),t=$("#zy_section_one_bg .zy_theme_bg_content")):s==ZY.config.categoryIds.sectionFourId?(ZY.uiManager.updateSectionBg(o,$("#zy_section_four_theme")),i=$("#zy_section_four_bg .zy_theme_bg_content")):s==ZY.config.categoryIds.sectionThreeId&&(ZY.uiManager.updateSectionBg(o,$("#zy_section_three_theme")),n=$("#zy_section_three_bg .zy_theme_bg_content")))},bindHScroll:function(e){var t=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",a=function(t){var a=0;t=window.event||t,a=t.wheelDelta<0||t.detail>0?e.scrollLeft+500:e.scrollLeft-500,TweenLite.to(e,.5,{scrollTo:{x:a}}),t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!1)};e.addEventListener(t,a)},setWheelScrollSpeed:function(){var e=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",t=function(e){var t=$(window).scrollTop();e=window.event||e,$(window).scrollTop(e.wheelDelta<0||e.detail>0?t+100:t-100),e.preventDefault?e.preventDefault():e.returnValue=!1};window.addEventListener(e,t)},scrollingHandler:function(){var _=window.pageYOffset,g=$(window).height();_>=e?o.hasClass("zy_nav_active")||o.addClass("zy_nav_active"):o.hasClass("zy_nav_active")&&o.removeClass("zy_nav_active"),$("#zy_nav ul li a").removeClass("active"),s>=_||(l>=_?$("#zy_nav ul li:nth-child(1) a").addClass("active"):c>=_?$("#zy_nav ul li:nth-child(2) a").addClass("active"):r>=_?$("#zy_nav ul li:nth-child(4) a").addClass("active"):d>=_&&$("#zy_nav ul li:nth-child(5) a").addClass("active")),_>s-g&&s+800>=_?(ZY.config.deviceCode.iOS||t.addClass("zy_bg_fixed"),ZY.dataManager.landscapeLoaded||ZY.dataManager.swiper1||(ZY.dataManager.swiper1=new Swiper(".swiper1",{pagination:".swiper-pagination1",paginationClickable:!0,simulateTouch:!0,direction:"horizontal",slidesPerView:3,spaceBetween:20,breakpoints:{960:{slidesPerView:2,spaceBetween:20},640:{slidesPerView:1,spaceBetween:10}},onReachEnd:function(e){if(-1!=e.lastDate){var t=e.lastDate?3:6;ZY.dataManager.getCategoryPosts({limit:t,lastDate:e.lastDate?e.lastDate:"",categoryId:ZY.config.categoryIds.sectionOneId,callback:function(a){var n=$("#zy_section_one_articles_tpl").html(),i=juicer(n,{posts:a});e.appendSlide(i),e.update(),e.lastDate=a.length<t?-1:a[a.length-1].post_full_date,ZY.dataManager.landscapeLoaded=!0}})}}}))):ZY.config.deviceCode.iOS||t.removeClass("zy_bg_fixed"),_>l-g&&l+800>=_?(ZY.config.deviceCode.iOS||a.addClass("zy_bg_fixed"),ZY.dataManager.peopleLoaded||ZY.dataManager.swiper2||(ZY.dataManager.swiper2=new Swiper(".swiper2",{pagination:".swiper-pagination2",paginationClickable:!0,simulateTouch:!0,direction:"horizontal",slidesPerView:4,spaceBetween:20,breakpoints:{960:{slidesPerView:3,spaceBetween:20},640:{slidesPerView:1,spaceBetween:10}},onReachEnd:function(e){if(-1!=e.lastDate){var t=e.lastDate?4:8;ZY.dataManager.getCategoryPosts({limit:t,lastDate:e.lastDate?e.lastDate:"",categoryId:ZY.config.categoryIds.sectionTwoId,callback:function(a){var n=$("#zy_section_two_articles_tpl").html(),i=juicer(n,{posts:a});e.appendSlide(i),e.update(),e.lastDate=a.length<t?-1:a[a.length-1].post_full_date,ZY.dataManager.peopleLoaded=!0}})}}}))):ZY.config.deviceCode.iOS||a.removeClass("zy_bg_fixed"),_>c-g&&c+840>=_?(ZY.config.deviceCode.iOS||n.addClass("zy_bg_fixed"),ZY.dataManager.artifactLoaded||ZY.dataManager.swiper3||(ZY.dataManager.swiper3=new Swiper(".swiper3",{pagination:".swiper-pagination3",paginationClickable:!0,simulateTouch:!0,direction:"horizontal",slidesPerView:3,spaceBetween:20,breakpoints:{960:{slidesPerView:2,spaceBetween:20},640:{slidesPerView:1,spaceBetween:10}},onReachEnd:function(e){if(-1!=e.lastDate){var t=e.lastDate?3:6;ZY.dataManager.getCategoryPosts({limit:t,lastDate:e.lastDate?e.lastDate:"",categoryId:ZY.config.categoryIds.sectionThreeId,callback:function(a){var n=$("#zy_section_three_articles_tpl").html(),i=juicer(n,{posts:a});e.appendSlide(i),e.update(),e.lastDate=a.length<t?-1:a[a.length-1].post_full_date,ZY.dataManager.artifactLoaded=!0}})}}}))):ZY.config.deviceCode.iOS||n.removeClass("zy_bg_fixed"),_>r-g&&r+840>=_?(ZY.config.deviceCode.iOS||i.addClass("zy_bg_fixed"),ZY.dataManager.communityLoaded||ZY.dataManager.swiper4||(ZY.dataManager.swiper4=new Swiper(".swiper4",{pagination:".swiper-pagination4",paginationClickable:!0,simulateTouch:!0,direction:"horizontal",slidesPerView:4,spaceBetween:20,breakpoints:{960:{slidesPerView:3,spaceBetween:20},640:{slidesPerView:1,spaceBetween:10}},onReachEnd:function(e){if(-1!=e.lastDate){var t=e.lastDate?4:8;ZY.dataManager.getCategoryPosts({limit:t,lastDate:e.lastDate?e.lastDate:"",categoryId:ZY.config.categoryIds.sectionFourId,callback:function(a){var n=$("#zy_section_four_articles_tpl").html(),i=juicer(n,{posts:a});e.appendSlide(i),e.update(),e.lastDate=a.length<t?-1:a[a.length-1].post_full_date,ZY.dataManager.communityLoaded=!0}})}}}))):ZY.config.deviceCode.iOS||i.removeClass("zy_bg_fixed")}}}();