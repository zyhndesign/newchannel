var ZY=ZY||{};ZY.controllerManager=function(){var e=0,t=-100,a=-200,o=-180,i=-600,n=-380,s=150,c=-60,l=-200,d=$("#zy_landscape_bg .zy_theme_bg_content"),r=$("#zy_people_bg .zy_theme_bg_content"),p=$("#zy_artifact_bg .zy_theme_bg_content"),_=$("#zy_community_bg .zy_theme_bg_content"),g=$(".zy_featured").offset().top,f=$("#zy_landscape").offset().top,u=$("#zy_people").offset().top,y=$("#zy_artifact").offset().top,w=$("#zy_community").offset().top,m=$(".zy_footer").offset().top,h=$("#zy_featured_left"),b=$("#zy_featured_right"),z=$("#zy_landscape_left"),v=$("#zy_landscape_right"),Y=$("#zy_people_left"),Z=$("#zy_people_top"),D=$("#zy_people_right"),M=$("#zy_artifact_left"),C=$("#zy_artifact_bottom"),S=$("#zy_community_bottom");return{judgeShowOrNot:function(e,t){0==t.parents(e).length&&ZY.uiManager.hideMusicPlayer()},splitPostDate:function(e){if("string"==typeof e){var t=e.split("-"),a=[];return a[0]=t[2]+"/"+t[1],a[1]=t[0],a}return[]},transformDatas:function(e){var t=this,a=[];return $.each(e,function(e,o){a=t.splitPostDate(o.post_date),o.post_month=a[0],o.post_year=a[1]}),e},setBackGround:function(e,t,a){e&&t.post_id!=ZY.dataManager.topPostId&&(a==ZY.config.categoryIds.sectionTwoId?(ZY.uiManager.updateSectionBg(t,$("#zy_section_two_theme")),r=$("#zy_section_two_bg .zy_theme_bg_content")):a==ZY.config.categoryIds.sectionOneId?(ZY.uiManager.updateSectionBg(t,$("#zy_section_one_theme")),d=$("#zy_section_one_bg .zy_theme_bg_content")):a==ZY.config.categoryIds.sectionFourId?(ZY.uiManager.updateSectionBg(t,$("#zy_section_four_theme")),_=$("#zy_section_four_bg .zy_theme_bg_content")):a==ZY.config.categoryIds.sectionThreeId&&(ZY.uiManager.updateSectionBg(t,$("#zy_section_three_theme")),p=$("#zy_section_three_bg .zy_theme_bg_content")))},bindHScroll:function(e){var t=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",a=function(t){var a=0;t=window.event||t,a=t.wheelDelta<0||t.detail>0?e.scrollLeft+500:e.scrollLeft-500,TweenLite.to(e,.5,{scrollTo:{x:a}}),t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!1)};e.addEventListener(t,a)},setWheelScrollSpeed:function(){var e=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",t=function(e){var t=$(window).scrollTop();e=window.event||e,$(window).scrollTop(e.wheelDelta<0||e.detail>0?t+100:t-100),e.preventDefault?e.preventDefault():e.returnValue=!1};window.addEventListener(e,t)},scrollingHandler:function(){var I=window.pageYOffset,P=$(window).height();$("#zy_nav ul li a").removeClass("active"),f>=I||(u>=I?$("#zy_nav ul li:nth-child(1) a").addClass("active"):y>=I?$("#zy_nav ul li:nth-child(2) a").addClass("active"):w>=I?$("#zy_nav ul li:nth-child(3) a").addClass("active"):m>=I&&$("#zy_nav ul li:nth-child(4) a").addClass("active")),I>f-P&&f+720>=I?(ZY.config.deviceCode.iOS||d.addClass("zy_bg_fixed"),ZY.dataManager.landscapeLoaded||ZY.dataManager.swiper1||(ZY.dataManager.swiper1=new Swiper(".swiper1",{pagination:".swiper-pagination1",paginationClickable:!0,simulateTouch:!0,direction:"horizontal",slidesPerView:3,spaceBetween:20,breakpoints:{960:{slidesPerView:2,spaceBetween:20},640:{slidesPerView:1,spaceBetween:10}},onReachEnd:function(e){if(-1!=e.lastDate){var t=e.lastDate?3:6;ZY.dataManager.getCategoryPosts({limit:t,lastDate:e.lastDate?e.lastDate:"",categoryId:ZY.config.categoryIds.landscapeId,callback:function(a){var o=$("#zy_landscape_articles_tpl").html(),i=juicer(o,{posts:a});e.appendSlide(i),e.update(),e.lastDate=a.length<t?-1:a[a.length-1].post_full_date,ZY.dataManager.landscapeLoaded=!0}})}}}))):ZY.config.deviceCode.iOS||d.removeClass("zy_bg_fixed"),I>u-P&&u+720>=I?(ZY.config.deviceCode.iOS||r.addClass("zy_bg_fixed"),ZY.dataManager.peopleLoaded||ZY.dataManager.swiper2||(ZY.dataManager.swiper2=new Swiper(".swiper2",{pagination:".swiper-pagination2",paginationClickable:!0,simulateTouch:!0,direction:"horizontal",slidesPerView:4,spaceBetween:20,breakpoints:{960:{slidesPerView:3,spaceBetween:20},640:{slidesPerView:1,spaceBetween:10}},onReachEnd:function(e){if(-1!=e.lastDate){var t=e.lastDate?4:8;ZY.dataManager.getCategoryPosts({limit:t,lastDate:e.lastDate?e.lastDate:"",categoryId:ZY.config.categoryIds.peopleId,callback:function(a){var o=$("#zy_people_articles_tpl").html(),i=juicer(o,{posts:a});e.appendSlide(i),e.update(),e.lastDate=a.length<t?-1:a[a.length-1].post_full_date,ZY.dataManager.peopleLoaded=!0}})}}}))):ZY.config.deviceCode.iOS||r.removeClass("zy_bg_fixed"),I>y-P&&y+720>=I?(ZY.config.deviceCode.iOS||p.addClass("zy_bg_fixed"),ZY.dataManager.artifactLoaded||ZY.dataManager.swiper3||(ZY.dataManager.swiper3=new Swiper(".swiper3",{pagination:".swiper-pagination3",paginationClickable:!0,simulateTouch:!0,direction:"horizontal",slidesPerView:3,spaceBetween:20,breakpoints:{960:{slidesPerView:2,spaceBetween:20},640:{slidesPerView:1,spaceBetween:10}},onReachEnd:function(e){if(-1!=e.lastDate){var t=e.lastDate?3:6;ZY.dataManager.getCategoryPosts({limit:t,lastDate:e.lastDate?e.lastDate:"",categoryId:ZY.config.categoryIds.artifactId,callback:function(a){var o=$("#zy_artifact_articles_tpl").html(),i=juicer(o,{posts:a});e.appendSlide(i),e.update(),e.lastDate=a.length<t?-1:a[a.length-1].post_full_date,ZY.dataManager.artifactLoaded=!0}})}}}))):ZY.config.deviceCode.iOS||p.removeClass("zy_bg_fixed"),I>w-P&&w+720>=I?(ZY.config.deviceCode.iOS||_.addClass("zy_bg_fixed"),ZY.dataManager.communityLoaded||ZY.dataManager.swiper4||(ZY.dataManager.swiper4=new Swiper(".swiper4",{pagination:".swiper-pagination4",paginationClickable:!0,simulateTouch:!0,direction:"horizontal",slidesPerView:4,spaceBetween:20,breakpoints:{960:{slidesPerView:3,spaceBetween:20},640:{slidesPerView:1,spaceBetween:10}},onReachEnd:function(e){if(-1!=e.lastDate){var t=e.lastDate?4:8;ZY.dataManager.getCategoryPosts({limit:t,lastDate:e.lastDate?e.lastDate:"",categoryId:ZY.config.categoryIds.communityId,callback:function(a){var o=$("#zy_community_articles_tpl").html(),i=juicer(o,{posts:a});e.appendSlide(i),e.update(),e.lastDate=a.length<t?-1:a[a.length-1].post_full_date,ZY.dataManager.communityLoaded=!0}})}}}))):ZY.config.deviceCode.iOS||_.removeClass("zy_bg_fixed"),ZY.config.deviceCode.iOS||(I>e?(I>=g-300&&0>=t+9&&(h.css("bottom",t+9),b.css("bottom",t+9),t+=9),I>f+500&&0>=a+18&&(z.css("bottom",a+18),v.css("bottom",a+18),a+=18),I>u&&(o-10>=-280&&(Z.css("top",o-10),o-=10),-400>=i+15&&(Y.css("bottom",i+15),i+=15),I>u+800&&-280>=n+15&&(D.css("bottom",n+15),n+=15)),I>y+300&&(s-10>=50&&(M.css("top",s-10),s-=10),I>y+800&&40>=c+10&&(C.css("bottom",c+10),c+=10)),I>w+800&&0>=l+15&&(S.css("bottom",l+15),l+=15)):(f>I&&t-9>=-100&&(h.css("bottom",t-9),b.css("bottom",t-9),t-=9),u>I&&a-18>=-200&&(z.css("bottom",a-18),v.css("bottom",a-18),a-=18),u+1600>I&&(u+1200>I&&-180>=o+10&&(Z.css("top",o+10),o+=10),u+1800>I&&(i-15>=-600&&(Y.css("bottom",i-15),i-=15),n-15>=-380&&(D.css("bottom",n-15),n-=15))),y+1600>I&&(y+1400>I&&150>=s+10&&(M.css("top",s+10),s+=10),c-10>=-60&&(C.css("bottom",c-10),c-=10)),m>I&&l-15>=-200&&(S.css("bottom",l-15),l-=15))),e=I}}}();