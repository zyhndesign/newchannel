!function(){module("controller",{setup:function(){this.posts=[{post_date:"2013-08-23",background:null,post_title:"ssss",post_excerpt:"dddd",post_mime_type:"zyslide",post_id:1,thumb:"http://localhot/dddd.jpg"},{post_date:"2012-03-23",background:null,post_title:"ssss",post_excerpt:"dddd",post_mime_type:"zyslide",post_id:2,thumb:"http://localhot/dddd.jpg"},{post_date:"2012-03-23",background:null,post_title:"ssss",post_excerpt:"dddd",post_mime_type:"zyslide",post_id:2,thumb:"http://localhot/dddd.jpg"}]},teardown:function(){}}),test("splitPostDate",function(){var t="2013-08-12",e=ZY.controllerManager.splitPostDate(t);equal(e.length,2,"return a array of 2 elements"),equal(e[0],"12/08","test first elements is 12/08"),equal(e[1],"2013","test second elements is 2013")}),test("transformDatas",function(){var t=ZY.controllerManager.transformDatas(this.posts);equal(t[0].post_month,"23/08","test month"),equal(t[0].post_year,"2013","test year")}),test("setLoadLimit",function(){var t=ZY.controllerManager.setLoadLimit({targetContain:$(".zy_contain"),isFirst:!0,width:240,categoryId:2});equal(t,15,"fullscreen limit is 15"),equal($(".zy_list_container").width(),1200,"test set width 1200"),equal($(".zy_contain_next").hasClass("zy_disable"),!0,"zy_disable class is added")}),test("doResponse",function(){function t(t){var e=$(".zy_contain"),s=$(".zy_contain_list"),a=t.type;"people"==a?s.attr("id","zy_people_list"):"landscape"==a?s.attr("id","zy_landscape_list"):"artifact"==a?s.attr("id","zy_artifact_list"):"community"==a&&s.attr("id","zy_community_list"),t.targetContain=e,t.limit=ZY.controllerManager.setLoadLimit(t),ZY.controllerManager.doResponse(t);var o=e.find(".zy_contain_next");equal(o.hasClass("zy_no_more"),!0,a+" zy_no_more class is added"),equal(o.hasClass("zy_disable"),!0,a+" zy_disable class is not removed"),"people"==a?equal(s.find("li.zy_people_article").length,3,a+" right count li"):"landscape"==a?equal(s.find("li.zy_landscape_article").length,2,a+" right count li"):"artifact"==a?equal(s.find("li.zy_artifact_article").length,2,a+" right count li"):"community"==a&&equal(s.find("li.zy_community_article").length,3,a+" right count li"),QUnit.reset()}t({type:"people",isFirst:!0,width:240,categoryId:2,posts:this.posts}),t({type:"landscape",isFirst:!0,width:320,categoryId:3,posts:this.posts}),t({type:"artifact",isFirst:!0,width:200,categoryId:5,posts:this.posts}),t({type:"community",isFirst:!0,width:240,categoryId:4,posts:this.posts})}),test("handlerLandscapePosts",function(){var t=ZY.controllerManager.handlerLandscapePosts(this.posts,3),e=t[0];equal(t.length,2,"return array of 2 elements"),equal(e.hasOwnProperty("top"),!0,"first element has top property"),equal(e.hasOwnProperty("bottom"),!0,"first element has bottom property")}),test("handlerArtifactPosts",function(){function t(t){var e=ZY.controllerManager.handlerArtifactPosts(t.posts,t.length,t.isFirst),s=e[0],a=e[1];equal(e.length,2,"return array of 2 elements"),t.isFirst?(equal(s.hasOwnProperty("top"),!1,"first element has no top property"),equal(s.hasOwnProperty("bottom"),!1,"first element has no bottom property")):(equal(s.hasOwnProperty("top"),!0,"first element has  top property"),equal(s.hasOwnProperty("bottom"),!0,"first element has  bottom property")),equal(a.hasOwnProperty("top"),!0,"first element has  top property"),equal(a.hasOwnProperty("bottom"),!0,"first element has  bottom property")}t({posts:this.posts,length:3,isFirst:!0}),t({posts:this.posts,length:3,isFirst:!1})}),test("prevPage",function(){function t(t){for(var e=$(".zy_contain_list"),s=parseInt($("body").width()/t.width),a=$(".zy_contain_prev"),o=$(".zy_contain_next"),i=0;i<t.liNumber;i++)$("<li></li>").appendTo(e);e.css("left",-t.left),ZY.controllerManager.prevPage(t.contain,t.width,t.categoryId),stop(),setTimeout(function(){t.left<=s*t.width?(equal(e.css("left"),"0px","left is 0"),equal(a.hasClass("zy_disable"),!0,"prev has zy_disable class"),t.liNumber==s&&equal(o.hasClass("zy_disable"),!0,"next has zy_disable class")):equal(o.hasClass("zy_disable"),!1,"next has no zy_disable class"),start()},1e3)}var e=$(".zy_contain");t({width:340,categoryId:2,liNumber:6,contain:e,left:300}),t({width:340,categoryId:2,liNumber:3,contain:e,left:300}),t({width:340,categoryId:2,liNumber:3,contain:e,left:1e3})})}();