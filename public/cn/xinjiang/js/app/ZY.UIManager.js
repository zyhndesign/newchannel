var ZY=ZY||{};ZY.UIManager=function(){var e=0,a=!1,t="",i=$("#zy_nav").height(),n=$("#zy_landscape_theme .zy_theme_bg_content"),o=$("#zy_people_theme .zy_theme_bg_content"),s=$("#zy_artifact_theme .zy_theme_bg_content"),c=$("#zy_community_theme .zy_theme_bg_content"),_=$(".zy_featured").offset().top,d=$("#zy_landscape").offset().top,l=$("#zy_people").offset().top,r=$("#zy_artifact").offset().top,p=$("#zy_community").offset().top,u=$(".zy_footer").offset().top,y=function(a){e=$("#zy_wrap").css("z-index"),$("#zy_wrap").css("z-index",a),$("#zy_wrap").hasClass("zy_hidden")&&$("#zy_wrap").removeClass("zy_hidden")},z=function(){$("#zy_wrap").hasClass("zy_hidden")||($("#zy_wrap").addClass("zy_hidden"),$("#zy_wrap").css("z-index",e))};return{musicLiLength:0,scrollToTarget:function(e){var a=$(e).offset().top;void 0!=a&&(TweenLite.killTweensOf(window),TweenLite.to(window,1,{scrollTo:{y:a+10,x:0}}))},showArticle:function(e,a){var t=this;$("#zy_article_content").find("article").remove(),y(9996),$("#zy_article_container").animate({left:"0%"},300,function(){t.callLoadingSpinner($("#zy_article_content")),ZY.DataManager.get_posts_detail(e,a)})},hideArticle:function(){$("#zy_article_container").animate({left:"100%"},300),z(),this.hideLoadingSpinner($("#zy_article_content"))},showVideoDetail:function(e){var a=this;$("#zy_show_load_container").html(""),y(9998),$("#zy_show_section").removeClass("zy_hidden"),$("#zy_show_load_container").load(e,function(e,t,i){a.hideLoadingSpinner($("#zy_article_content")),"error"==t&&a.popOutMsg(ZY.Config.errorCode.connectionError+i.status+" "+i.statusText)}),$("#zy_music_audio")[0].pause()},showImageDetail:function(e){y(9998),$("#zy_show_section").removeClass("zy_hidden"),$("#zy_show_load_container").html("<img src='"+e+"'>")},hideDetail:function(){var t=$("#zy_music_audio")[0];$("#zy_wrap").css("z-index",e),$("#zy_show_section").addClass("zy_hidden"),$("#zy_show_load_container").html(""),a&&t.play()},initMusicPlayer:function(){var e=this,a=$("#zy_music_audio");$("#zy_music_control").click(function(){e.toggleMusicPlayPause()}),$("#zy_music_next").click(function(){e.nextMusic()}),a[0].addEventListener("timeupdate",function(){var e=$(this)[0],a=e.duration,t=e.currentTime;$("#zy_music_process_value").css("width",t/a*100+"%")}),a[0].addEventListener("ended",function(){e.nextMusic()})},toggleMusicPlayPause:function(){0!=this.musicLiLength&&($("#zy_music_control").hasClass("zy_music_play")?this.playMusic():$("#zy_music_control").hasClass("zy_music_pause")&&this.pauseMusic())},pauseMusic:function(){var e=$("#zy_music_audio");e[0].pause(),a=!1,e.attr("autoplay",!1),$("#zy_music_control").removeClass("zy_music_pause").addClass("zy_music_play")},playMusic:function(){var e=$("#zy_music_audio");e[0].play(),a=!0,e.attr("autoplay","autoplay"),$("#zy_music_control").addClass("zy_music_pause").removeClass("zy_music_play")},nextMusic:function(){if(0!=this.musicLiLength){$("#zy_music_process_value").stop().width("0%");var e=0!=$(".active_music").next().length?$(".active_music").next():$("#zy_music_list li:eq(0)");$(".active_music").removeClass("active_music"),$("#zy_music_audio").attr("src",e.html()),$("#zy_music_author").html("Directed by "+e.data("music-author")),$("#zy_music_title").html(e.data("music-title")),e.addClass("active_music")}},popOutInit:function(){var e=this;$("#zy_popout_win>.zy_popout_btn").on("click",function(){e.popOutHide()}),$("#zy_popout_win").hasClass("zy_hidden")||$("#zy_popout_win").addClass("zy_hidden")},popOutMsg:function(e,a){$("#zy_popout_win").hasClass("zy_hidden")&&$("#zy_popout_win").removeClass("zy_hidden").find(".zy_popout_title").html(e),a&&y(9999)},popOutHide:function(){$("#zy_popout_win").addClass("zy_hidden").find(".zy_popout_title").html("")},callLoadingSpinner:function(e){var a="<div class='zy_loading_spinner'><div class='zy_loading_spinner_layer1'></div><div class='zy_loading_spinner_layer2'></div></div>",t=$(a);$(e).find(".zy_loading_spinner").length<=0&&$(e).append(t)},hideLoadingSpinner:function(e){$(e).find(".zy_loading_spinner").detach()},updateSectionBG:function(e,a){e.background&&("mp4"!=e.background.type?$(a).append($("<img class='zy_theme_bg_content' src='"+e.background.filepath+"' onload='ZY.UIManager.fadingIn(this)' />")):ZY.Config.deviceCode.iOS||$(a).append($("<video class='zy_theme_bg_content' autoplay loop muted oncanplay='ZY.UIManager.fadingIn(this)'><source src='"+e.background.filepath+"' type='video/mp4' /></video>")),n=$("#zy_landscape_theme .zy_theme_bg_content"),o=$("#zy_people_theme .zy_theme_bg_content"),s=$("#zy_artifact_theme .zy_theme_bg_content"),c=$("#zy_community_theme .zy_theme_bg_content"))},bindHScrollOnWheel:function(e){var a=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",t=function(a){var t=0;a=window.event||a,t=a.wheelDelta<0||a.detail>0?e.scrollLeft+500:e.scrollLeft-500,TweenLite.to(e,.5,{scrollTo:{x:t}}),a.preventDefault?(a.preventDefault(),a.stopPropagation()):(a.returnValue=!1,a.cancelBubble=!1)};e.addEventListener(a,t)},setWheelScrollSpeed:function(){var e=void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",a=function(e){var a=$(window).scrollTop();e=window.event||e,$(window).scrollTop(e.wheelDelta<0||e.detail>0?a+100:a-100),e.preventDefault?e.preventDefault():e.returnValue=!1};window.addEventListener(e,a)},fadingIn:function(e){$(e).css("opacity",1)},scrollingHandler:function(){var e=window.pageYOffset,a=$(window).height(),y=$(window).width();_>=e&&$("#zy_nav").css("top",100+(d-i-200)/_*e),$(".zy_top_nav ul li a").removeClass("active"),d>=e||(l>=e?$(".zy_top_nav ul li:nth-child(1) a").addClass("active"):r>=e?$(".zy_top_nav ul li:nth-child(2) a").addClass("active"):p>=e?$(".zy_top_nav ul li:nth-child(3) a").addClass("active"):u>=e&&$(".zy_top_nav ul li:nth-child(4) a").addClass("active")),e>d-a&&d+720>=e?(ZY.Config.deviceCode.iOS||(n.addClass("zy_bg_fixed"),t="rect(0px "+y+"px "+(720-(e-d)+100)+"px 0px)",n.css("clip",t)),ZY.DataManager.landscapeLoaded||(ZY.DataManager.zy_get_posts($("#zy_landscape_contain"),240,3,ZY.DataManager.lastLandscapeDate,!0),ZY.DataManager.landscapeLoaded=!0)):ZY.Config.deviceCode.iOS||(n.removeClass("zy_bg_fixed"),n.css("clip","")),e>l-a&&l+720>=e?(ZY.Config.deviceCode.iOS||(o.addClass("zy_bg_fixed"),t="rect(0px "+y+"px "+(720-(e-l)+100)+"px 0px)",o.css("clip",t)),ZY.DataManager.peopleLoaded||(ZY.DataManager.zy_get_posts($("#zy_people_contain"),340,2,ZY.DataManager.lastPeopleDate,!0),ZY.DataManager.peopleLoaded=!0)):ZY.Config.deviceCode.iOS||(o.removeClass("zy_bg_fixed"),o.css("clip","")),e>r-a&&r+720>=e?(ZY.Config.deviceCode.iOS||(s.addClass("zy_bg_fixed"),t="rect(0px "+y+"px "+(720-(e-r)+100)+"px 0px)",s.css("clip",t)),ZY.DataManager.artifactLoaded||(ZY.DataManager.zy_get_posts($("#zy_artifact_contain"),400,5,ZY.DataManager.lastArtifactDate,!0),ZY.DataManager.artifactLoaded=!0)):ZY.Config.deviceCode.iOS||(s.removeClass("zy_bg_fixed"),s.css("clip","")),e>p-a&&p+720>=e?(ZY.Config.deviceCode.iOS||(c.addClass("zy_bg_fixed"),t="rect(0px "+y+"px "+(720-(e-p)+100)+"px 0px)",c.css("clip",t)),ZY.DataManager.communityLoaded||(ZY.DataManager.zy_get_posts($("#zy_community_contain"),340,4,ZY.DataManager.lastCommunityDate,!0),ZY.DataManager.communityLoaded=!0)):ZY.Config.deviceCode.iOS||(c.removeClass("zy_bg_fixed"),c.css("clip",""))},doResizeOfCategory:function(e,a,t){var i=parseInt($("body").width()/a),n=e.find("a.zy_contain_next"),o=e.find("ul"),s=e.find(".zy_list_container");s.width(i*a),parseInt(o.css("left"))>-(o.find("li").length-i)*a&&t?n.removeClass("zy_disable"):t&&n.addClass("zy_disable")}}}();